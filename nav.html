<html class="scroll-smooth" lang="pt-BR">
 <head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1" name="viewport" />
  <title>Sistema de Navegação para Equipe de Arquitetos</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
    rel="stylesheet"
  />
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap"
    rel="stylesheet"
  />
  <style>
    body {
      font-family: "Inter", sans-serif;
    }
    #map {
      width: 100%;
      height: 500px;
      border-radius: 0.5rem;
      border: 1px solid #d1d5db;
      position: relative;
      background: url("https://placehold.co/1200x600?text=Mapa+Simulado+da+Equipe")
        center center no-repeat;
      background-size: cover;
      overflow: hidden;
    }
    .marker {
      position: absolute;
      transform: translate(-50%, -100%);
      cursor: pointer;
      user-select: none;
    }
    .marker .icon {
      font-size: 1.8rem;
      color: #2563eb;
      text-shadow: 0 0 3px #fff;
      transition: color 0.3s ease;
    }
    .marker.engineer .icon {
      color: #16a34a;
    }
    .marker:hover .icon {
      color: #1e40af;
    }
    .marker.engineer:hover .icon {
      color: #166534;
    }
    .marker .tooltip {
      position: absolute;
      bottom: 125%;
      left: 50%;
      transform: translateX(-50%);
      background: white;
      padding: 0.25rem 0.5rem;
      border-radius: 0.25rem;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
      font-size: 0.75rem;
      white-space: nowrap;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.2s ease-in-out;
      z-index: 10;
      user-select: none;
    }
    .marker:hover .tooltip,
    .marker:focus .tooltip {
      opacity: 1;
    }
    button:focus-visible,
    input:focus-visible,
    textarea:focus-visible,
    select:focus-visible {
      outline: 2px solid #2563eb;
      outline-offset: 2px;
    }
    /* Scrollbar for activity log */
    #activity-log {
      max-height: 200px;
      overflow-y: auto;
    }
    /* Calendar styles */
    #tekton-calendar {
      max-width: 900px;
      margin: 0 auto;
      background: white;
      border-radius: 0.5rem;
      box-shadow: 0 4px 12px rgb(0 0 0 / 0.1);
      border: 1px solid #d1d5db;
      user-select: none;
    }
    #calendar-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem 1.5rem;
      border-bottom: 1px solid #e5e7eb;
      background-color: #2563eb;
      color: white;
      border-top-left-radius: 0.5rem;
      border-top-right-radius: 0.5rem;
    }
    #calendar-header h3 {
      font-weight: 600;
      font-size: 1.25rem;
    }
    #calendar-header button {
      background: transparent;
      border: none;
      color: white;
      font-size: 1.25rem;
      cursor: pointer;
      padding: 0.25rem 0.5rem;
      border-radius: 0.375rem;
      transition: background-color 0.2s ease;
    }
    #calendar-header button:hover,
    #calendar-header button:focus-visible {
      background-color: rgba(255 255 255 / 0.3);
      outline: none;
    }
    #calendar-weekdays {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      background-color: #f3f4f6;
      border-bottom: 1px solid #e5e7eb;
      text-align: center;
      font-weight: 600;
      color: #374151;
      user-select: none;
    }
    #calendar-weekdays div {
      padding: 0.5rem 0;
      font-size: 0.875rem;
    }
    #calendar-days {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      grid-auto-rows: 100px;
      user-select: none;
    }
    .calendar-day {
      border-right: 1px solid #e5e7eb;
      border-bottom: 1px solid #e5e7eb;
      padding: 0.25rem 0.5rem;
      position: relative;
      cursor: pointer;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      overflow: hidden;
    }
    .calendar-day:last-child {
      border-right: none;
    }
    .calendar-day.inactive {
      color: #9ca3af;
      background-color: #f9fafb;
      cursor: default;
    }
    .calendar-day.today {
      background-color: #bfdbfe;
      font-weight: 700;
    }
    .calendar-day:hover:not(.inactive),
    .calendar-day:focus-visible:not(.inactive) {
      background-color: #dbeafe;
      outline: none;
    }
    .day-number {
      font-weight: 600;
      font-size: 0.875rem;
      margin-bottom: 0.25rem;
      user-select: text;
    }
    .events-container {
      flex-grow: 1;
      overflow-y: auto;
      max-height: 70px;
      scrollbar-width: thin;
      scrollbar-color: #93c5fd transparent;
    }
    .events-container::-webkit-scrollbar {
      height: 6px;
    }
    .events-container::-webkit-scrollbar-thumb {
      background-color: #93c5fd;
      border-radius: 3px;
    }
    .event {
      background-color: #2563eb;
      color: white;
      font-size: 0.75rem;
      padding: 1px 4px;
      border-radius: 0.25rem;
      margin-bottom: 2px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      user-select: text;
    }
    .event.engineer {
      background-color: #16a34a;
    }
    /* Modal styles */
    #event-modal {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.5);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 50;
    }
    #event-modal.active {
      display: flex;
    }
    #event-modal-content {
      background: white;
      border-radius: 0.5rem;
      max-width: 400px;
      width: 90%;
      padding: 1.5rem;
      box-shadow: 0 10px 25px rgb(0 0 0 / 0.2);
      max-height: 90vh;
      overflow-y: auto;
      outline: none;
    }
    #event-modal-content h3 {
      font-size: 1.25rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
    }
    #event-modal-content p {
      margin-bottom: 1rem;
      white-space: pre-wrap;
    }
    #event-modal-close {
      position: absolute;
      top: 0.5rem;
      right: 0.5rem;
      background: transparent;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      color: #374151;
      transition: color 0.2s ease;
    }
    #event-modal-close:hover,
    #event-modal-close:focus-visible {
      color: #2563eb;
      outline: none;
    }
  </style>
 </head>
 <body class="bg-gray-50 min-h-screen flex flex-col">
  <main
    class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"
    role="main"
    aria-label="Sistema Integrado de Navegação e Coordenação para Equipe de Arquitetura"
  >
   <!-- Título -->
   <header class="mb-8 text-center">
    <h1 class="text-3xl font-bold text-blue-700" tabindex="0">
     Sistema Integrado de Navegação e Coordenação - Equipe de Arquitetura
    </h1>
    <p class="text-gray-600 mt-2 max-w-xl mx-auto" tabindex="0">
     Navegue, acompanhe e coordene os trabalhos em campo com facilidade.
    </p>
   </header>
   <!-- Mapa e Navegação -->
<!-- Adicione Leaflet CSS no <head> do seu site -->
    <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
  />
  
  <!-- SEÇÃO DO MAPA -->
  <section
    class="mb-10"
    id="mapa"
    aria-label="Mapa e navegação da equipe"
    tabindex="-1"
  >
    <h2
      class="text-2xl font-semibold text-gray-800 mb-4 flex items-center justify-center space-x-2"
      tabindex="0"
    >
      <i class="fas fa-map-marked-alt text-blue-600" aria-hidden="true"></i>
      <span>Mapa Interativo da Equipe</span>
    </h2>
  
    <div
      aria-label="Mapa interativo da equipe com marcadores de localização"
      class="relative bg-white shadow-lg"
      id="map"
      role="region"
      tabindex="0"
      style="height: 400px; border-radius: 0.5rem;" <!-- importante definir altura -->
    ></div>
  
    <div
      class="mt-6 flex flex-col sm:flex-row sm:space-x-4 space-y-3 sm:space-y-0 justify-center"
      role="group"
      aria-label="Controles do mapa"
    >
      <button
        aria-label="Ativar GPS e obter localização atual"
        class="flex items-center justify-center space-x-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold px-5 py-3 rounded-md shadow-md transition focus-visible:outline focus-visible:outline-2 focus-visible:outline-blue-600"
        id="btn-ativar-gps"
        type="button"
      >
        <i class="fas fa-location-arrow" aria-hidden="true"></i>
        <span>Ativar GPS</span>
      </button>
  
      <button
        aria-label="Gerar rota otimizada entre membros da equipe"
        class="flex items-center justify-center space-x-2 bg-green-600 hover:bg-green-700 text-white font-semibold px-5 py-3 rounded-md shadow-md transition focus-visible:outline focus-visible:outline-2 focus-visible:outline-green-600"
        id="btn-gerar-rota"
        type="button"
      >
        <i class="fas fa-route" aria-hidden="true"></i>
        <span>Gerar Rota</span>
      </button>
  
      <button
        aria-label="Atualizar posições da equipe no mapa"
        class="flex items-center justify-center space-x-2 bg-gray-600 hover:bg-gray-700 text-white font-semibold px-5 py-3 rounded-md shadow-md transition focus-visible:outline focus-visible:outline-2 focus-visible:outline-gray-600"
        id="btn-atualizar-posicao"
        type="button"
      >
        <i class="fas fa-sync-alt" aria-hidden="true"></i>
        <span>Atualizar Posições</span>
      </button>
    </div>
  
    <div
      id="map-feedback"
      role="alert"
      aria-live="polite"
      class="mt-3 text-center text-sm font-semibold text-green-700 hidden"
    ></div>
  </section>
  
  <!-- Adicione Leaflet JS no final do <body> -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      // Inicializa o mapa
      const map = L.map('map').setView([-23.55052, -46.633308], 13); // Posição inicial (São Paulo)
  
      // Carrega os tiles do mapa
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; OpenStreetMap contributors'
      }).addTo(map);
  
      // Marca inicial
      const marker = L.marker([-23.55052, -46.633308]).addTo(map)
        .bindPopup('Localização Inicial')
        .openPopup();
  
      // Botão: Ativar GPS
      document.getElementById('btn-ativar-gps').addEventListener('click', function () {
        if (!navigator.geolocation) {
          alert('Geolocalização não suportada pelo navegador.');
          return;
        }
        navigator.geolocation.getCurrentPosition(function (position) {
          const lat = position.coords.latitude;
          const lon = position.coords.longitude;
  
          // Move o mapa e adiciona marcador
          map.setView([lat, lon], 15);
          L.marker([lat, lon]).addTo(map)
            .bindPopup('Sua Localização')
            .openPopup();
  
          const feedback = document.getElementById('map-feedback');
          feedback.textContent = 'Localização atualizada!';
          feedback.classList.remove('hidden');
        }, function () {
          alert('Não foi possível obter sua localização.');
        });
      });
  
      // Botão: Atualizar posição
      document.getElementById('btn-atualizar-posicao').addEventListener('click', function () {
        document.getElementById('btn-ativar-gps').click();
      });
  
      // Botão: Gerar Rota (Exemplo entre dois pontos)
      document.getElementById('btn-gerar-rota').addEventListener('click', function () {
        const pointA = new L.LatLng(-23.55052, -46.633308);
        const pointB = new L.LatLng(-23.559616, -46.658684);
        const pointList = [pointA, pointB];
  
        const firstpolyline = new L.Polyline(pointList, {
          color: 'blue',
          weight: 4,
          opacity: 0.7,
          smoothFactor: 1
        });
        firstpolyline.addTo(map);
  
        map.fitBounds(firstpolyline.getBounds());
  
        const feedback = document.getElementById('map-feedback');
        feedback.textContent = 'Rota gerada!';
        feedback.classList.remove('hidden');
      });
    });
  </script>
  
   <!-- Tarefas -->
   <section
     class="mb-10"
     id="tarefas"
     aria-label="Lista de tarefas em campo"
     tabindex="-1"
   >
    <h2
      class="text-2xl font-semibold text-gray-800 mb-4 flex items-center justify-center space-x-2"
      tabindex="0"
    >
     <i class="fas fa-tasks text-blue-600" aria-hidden="true"></i>
     <span>Tarefas em Campo</span>
    </h2>
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 max-w-7xl mx-auto">
     <article
       aria-label="Tarefa Visita ao canteiro A, status Em andamento, prazo 28 de junho de 2024"
       class="bg-white rounded-lg shadow-md border border-gray-200 p-5 flex flex-col justify-between"
       data-id="1"
       tabindex="0"
     >
      <div>
       <h3 class="text-lg font-semibold text-gray-900 mb-2">Visita ao canteiro A</h3>
       <p class="text-gray-700 mb-3">
        Conferir alinhamento das paredes e posicionamento das janelas.
       </p>
       <p class="text-sm text-gray-500">Prazo: 28/06/2024</p>
      </div>
      <div class="mt-4 flex items-center justify-between">
       <span
         class="status text-sm font-medium text-green-700 bg-green-100 px-2 py-1 rounded-full"
         aria-live="polite"
         aria-atomic="true"
         >Em andamento</span
       >
       <button
         aria-label="Marcar tarefa Visita ao canteiro A como concluída"
         class="btn-concluir text-blue-600 hover:text-blue-800 focus:outline-none focus-visible:outline-2 focus-visible:outline-blue-600"
         type="button"
       >
        <i class="fas fa-check-circle fa-lg" aria-hidden="true"></i>
       </button>
      </div>
     </article>
     <article
       aria-label="Tarefa Revisão do projeto estrutural, status Pendente, prazo 30 de junho de 2024"
       class="bg-white rounded-lg shadow-md border border-gray-200 p-5 flex flex-col justify-between"
       data-id="2"
       tabindex="0"
     >
      <div>
       <h3 class="text-lg font-semibold text-gray-900 mb-2">
        Revisão do projeto estrutural
       </h3>
       <p class="text-gray-700 mb-3">
        Validar cálculos e materiais com o engenheiro responsável.
       </p>
       <p class="text-sm text-gray-500">Prazo: 30/06/2024</p>
      </div>
      <div class="mt-4 flex items-center justify-between">
       <span
         class="status text-sm font-medium text-yellow-700 bg-yellow-100 px-2 py-1 rounded-full"
         aria-live="polite"
         aria-atomic="true"
         >Pendente</span
       >
       <button
         aria-label="Marcar tarefa Revisão do projeto estrutural como concluída"
         class="btn-concluir text-blue-600 hover:text-blue-800 focus:outline-none focus-visible:outline-2 focus-visible:outline-blue-600"
         type="button"
       >
        <i class="fas fa-check-circle fa-lg" aria-hidden="true"></i>
       </button>
      </div>
     </article>
     <article
       aria-label="Tarefa Atualizar planta baixa, status Atrasada, prazo 2 de julho de 2024"
       class="bg-white rounded-lg shadow-md border border-gray-200 p-5 flex flex-col justify-between"
       data-id="3"
       tabindex="0"
     >
      <div>
       <h3 class="text-lg font-semibold text-gray-900 mb-2">Atualizar planta baixa</h3>
       <p class="text-gray-700 mb-3">Incorporar alterações solicitadas pelo cliente.</p>
       <p class="text-sm text-gray-500">Prazo: 02/07/2024</p>
      </div>
      <div class="mt-4 flex items-center justify-between">
       <span
         class="status text-sm font-medium text-red-700 bg-red-100 px-2 py-1 rounded-full"
         aria-live="polite"
         aria-atomic="true"
         >Atrasada</span
       >
       <button
         aria-label="Marcar tarefa Atualizar planta baixa como concluída"
         class="btn-concluir text-blue-600 hover:text-blue-800 focus:outline-none focus-visible:outline-2 focus-visible:outline-blue-600"
         type="button"
       >
        <i class="fas fa-check-circle fa-lg" aria-hidden="true"></i>
       </button>
      </div>
     </article>
     <article
       aria-label="Tarefa Inspeção elétrica, status Pendente, prazo 5 de julho de 2024"
       class="bg-white rounded-lg shadow-md border border-gray-200 p-5 flex flex-col justify-between"
       data-id="4"
       tabindex="0"
     >
      <div>
       <h3 class="text-lg font-semibold text-gray-900 mb-2">Inspeção elétrica</h3>
       <p class="text-gray-700 mb-3">Verificar instalação e segurança dos cabos.</p>
       <p class="text-sm text-gray-500">Prazo: 05/07/2024</p>
      </div>
      <div class="mt-4 flex items-center justify-between">
       <span
         class="status text-sm font-medium text-yellow-700 bg-yellow-100 px-2 py-1 rounded-full"
         aria-live="polite"
         aria-atomic="true"
         >Pendente</span
       >
       <button
         aria-label="Marcar tarefa Inspeção elétrica como concluída"
         class="btn-concluir text-blue-600 hover:text-blue-800 focus:outline-none focus-visible:outline-2 focus-visible:outline-blue-600"
         type="button"
       >
        <i class="fas fa-check-circle fa-lg" aria-hidden="true"></i>
       </button>
      </div>
     </article>
     <article
       aria-label="Tarefa Reunião com cliente, status Em andamento, prazo 7 de julho de 2024"
       class="bg-white rounded-lg shadow-md border border-gray-200 p-5 flex flex-col justify-between"
       data-id="5"
       tabindex="0"
     >
      <div>
       <h3 class="text-lg font-semibold text-gray-900 mb-2">Reunião com cliente</h3>
       <p class="text-gray-700 mb-3">Apresentar progresso e discutir ajustes.</p>
       <p class="text-sm text-gray-500">Prazo: 07/07/2024</p>
      </div>
      <div class="mt-4 flex items-center justify-between">
       <span
         class="status text-sm font-medium text-green-700 bg-green-100 px-2 py-1 rounded-full"
         aria-live="polite"
         aria-atomic="true"
         >Em andamento</span
       >
       <button
         aria-label="Marcar tarefa Reunião com cliente como concluída"
         class="btn-concluir text-blue-600 hover:text-blue-800 focus:outline-none focus-visible:outline-2 focus-visible:outline-blue-600"
         type="button"
       >
        <i class="fas fa-check-circle fa-lg" aria-hidden="true"></i>
       </button>
      </div>
     </article>
     <article
       aria-label="Tarefa Levantamento topográfico, status Pendente, prazo 10 de julho de 2024"
       class="bg-white rounded-lg shadow-md border border-gray-200 p-5 flex flex-col justify-between"
       data-id="6"
       tabindex="0"
     >
      <div>
       <h3 class="text-lg font-semibold text-gray-900 mb-2">Levantamento topográfico</h3>
       <p class="text-gray-700 mb-3">Coletar dados para atualização do projeto.</p>
       <p class="text-sm text-gray-500">Prazo: 10/07/2024</p>
      </div>
      <div class="mt-4 flex items-center justify-between">
       <span
         class="status text-sm font-medium text-yellow-700 bg-yellow-100 px-2 py-1 rounded-full"
         aria-live="polite"
         aria-atomic="true"
         >Pendente</span
       >
       <button
         aria-label="Marcar tarefa Levantamento topográfico como concluída"
         class="btn-concluir text-blue-600 hover:text-blue-800 focus:outline-none focus-visible:outline-2 focus-visible:outline-blue-600"
         type="button"
       >
        <i class="fas fa-check-circle fa-lg" aria-hidden="true"></i>
       </button>
      </div>
     </article>
    </div>
   </section>
   <!-- Equipe -->
   <section
     class="mb-10"
     id="equipe"
     aria-label="Equipe em campo"
     tabindex="-1"
   >
    <h2
      class="text-2xl font-semibold text-gray-800 mb-4 flex items-center justify-center space-x-2"
      tabindex="0"
    >
     <i class="fas fa-users text-blue-600" aria-hidden="true"></i>
     <span>Equipe em Campo</span>
    </h2>
    <div
      class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 max-w-7xl mx-auto"
    >
     <article
       aria-label="Lucas Silva, Arquiteto, localizado em Canteiro A"
       class="bg-white rounded-lg shadow-md border border-gray-200 p-5 flex items-center space-x-4"
       tabindex="0"
     >
      <img
        alt="Foto do arquiteto Lucas, homem jovem com cabelo castanho curto e óculos, sorrindo"
        class="w-20 h-20 rounded-full object-cover border-2 border-blue-600"
        height="80"
        loading="lazy"
        src="https://storage.googleapis.com/a1aa/image/fa044415-9805-4d7e-9259-92317f687f3c.jpg"
        width="80"
      />
      <div>
       <h3 class="text-lg font-semibold text-gray-900">Lucas Silva</h3>
       <p class="text-sm text-gray-600">Arquiteto</p>
       <p class="text-sm text-green-600 flex items-center space-x-1">
        <i class="fas fa-map-marker-alt" aria-hidden="true"></i>
        <span>Localização: Canteiro A</span>
       </p>
      </div>
     </article>
     <article
       aria-label="Mariana Costa, Engenheira, localizada em Canteiro B"
       class="bg-white rounded-lg shadow-md border border-gray-200 p-5 flex items-center space-x-4"
       tabindex="0"
     >
      <img
        alt="Foto da engenheira Mariana, mulher jovem com cabelo preto longo preso em rabo de cavalo, usando capacete amarelo"
        class="w-20 h-20 rounded-full object-cover border-2 border-green-600"
        height="80"
        loading="lazy"
        src="https://storage.googleapis.com/a1aa/image/17b39fdb-265c-4699-0415-efd3bb2186a7.jpg"
        width="80"
      />
      <div>
       <h3 class="text-lg font-semibold text-gray-900">Mariana Costa</h3>
       <p class="text-sm text-gray-600">Engenheira</p>
       <p class="text-sm text-green-600 flex items-center space-x-1">
        <i class="fas fa-map-marker-alt" aria-hidden="true"></i>
        <span>Localização: Canteiro B</span>
       </p>
      </div>
     </article>
     <article
       aria-label="Ana Pereira, Arquiteta, localizada em Escritório Central"
       class="bg-white rounded-lg shadow-md border border-gray-200 p-5 flex items-center space-x-4"
       tabindex="0"
     >
      <img
        alt="Foto da arquiteta Ana, mulher de pele clara, cabelo loiro curto, usando óculos de grau"
        class="w-20 h-20 rounded-full object-cover border-2 border-blue-600"
        height="80"
        loading="lazy"
        src="https://storage.googleapis.com/a1aa/image/26b32f3e-355a-4bf9-4224-ed5dff2ba9be.jpg"
        width="80"
      />
      <div>
       <h3 class="text-lg font-semibold text-gray-900">Ana Pereira</h3>
       <p class="text-sm text-gray-600">Arquiteta</p>
       <p class="text-sm text-green-600 flex items-center space-x-1">
        <i class="fas fa-map-marker-alt" aria-hidden="true"></i>
        <span>Localização: Escritório Central</span>
       </p>
      </div>
     </article>
     <article
       aria-label="Carlos Mendes, Engenheiro, localizado em Canteiro C"
       class="bg-white rounded-lg shadow-md border border-gray-200 p-5 flex items-center space-x-4"
       tabindex="0"
     >
      <img
        alt="Foto do engenheiro Carlos, homem de pele morena clara, cabelo curto e barba rala"
        class="w-20 h-20 rounded-full object-cover border-2 border-green-600"
        height="80"
        loading="lazy"
        src="https://storage.googleapis.com/a1aa/image/3c6de903-9437-43bb-4524-2c88de5d5643.jpg"
        width="80"
      />
      <div>
       <h3 class="text-lg font-semibold text-gray-900">Carlos Mendes</h3>
       <p class="text-sm text-gray-600">Engenheiro</p>
       <p class="text-sm text-green-600 flex items-center space-x-1">
        <i class="fas fa-map-marker-alt" aria-hidden="true"></i>
        <span>Localização: Canteiro C</span>
       </p>
      </div>
     </article>
     <article
       aria-label="Beatriz Lima, Arquiteta, localizada em Escritório Central"
       class="bg-white rounded-lg shadow-md border border-gray-200 p-5 flex items-center space-x-4"
       tabindex="0"
     >
      <img
        alt="Foto da arquiteta Beatriz, mulher jovem, cabelo castanho claro longo e liso"
        class="w-20 h-20 rounded-full object-cover border-2 border-blue-600"
        height="80"
        loading="lazy"
        src="https://storage.googleapis.com/a1aa/image/952e5756-daa1-4dc5-2889-e302e9085f60.jpg"
        width="80"
      />
      <div>
       <h3 class="text-lg font-semibold text-gray-900">Beatriz Lima</h3>
       <p class="text-sm text-gray-600">Arquiteta</p>
       <p class="text-sm text-green-600 flex items-center space-x-1">
        <i class="fas fa-map-marker-alt" aria-hidden="true"></i>
        <span>Localização: Escritório Central</span>
       </p>
      </div>
     </article>
     <article
       aria-label="Felipe Santos, Engenheiro, localizado em Canteiro A"
       class="bg-white rounded-lg shadow-md border border-gray-200 p-5 flex items-center space-x-4"
       tabindex="0"
     >
      <img
        alt="Foto do engenheiro Felipe, homem jovem, cabelo castanho escuro e barba cheia"
        class="w-20 h-20 rounded-full object-cover border-2 border-green-600"
        height="80"
        loading="lazy"
        src="https://storage.googleapis.com/a1aa/image/3b95651a-fe42-4858-315a-d35f98b48b3f.jpg"
        width="80"
      />
      <div>
       <h3 class="text-lg font-semibold text-gray-900">Felipe Santos</h3>
       <p class="text-sm text-gray-600">Engenheiro</p>
       <p class="text-sm text-green-600 flex items-center space-x-1">
        <i class="fas fa-map-marker-alt" aria-hidden="true"></i>
        <span>Localização: Canteiro A</span>
       </p>
      </div>
     </article>
     <article
       aria-label="Joana Ribeiro, Arquiteta, localizada em Canteiro B"
       class="bg-white rounded-lg shadow-md border border-gray-200 p-5 flex items-center space-x-4"
       tabindex="0"
     >
      <img
        alt="Foto da arquiteta Joana, mulher de pele morena clara, cabelo cacheado preto preso"
        class="w-20 h-20 rounded-full object-cover border-2 border-blue-600"
        height="80"
        loading="lazy"
        src="https://storage.googleapis.com/a1aa/image/d1960519-3708-4b1f-2b65-588f07329c6a.jpg"
        width="80"
      />
      <div>
       <h3 class="text-lg font-semibold text-gray-900">Joana Ribeiro</h3>
       <p class="text-sm text-gray-600">Arquiteta</p>
       <p class="text-sm text-green-600 flex items-center space-x-1">
        <i class="fas fa-map-marker-alt" aria-hidden="true"></i>
        <span>Localização: Canteiro B</span>
       </p>
      </div>
     </article>
     <article
       aria-label="Rafael Oliveira, Engenheiro, localizado em Escritório Central"
       class="bg-white rounded-lg shadow-md border border-gray-200 p-5 flex items-center space-x-4"
       tabindex="0"
     >
      <img
        alt="Foto do engenheiro Rafael, homem de pele clara, cabelo castanho curto e barba rala"
        class="w-20 h-20 rounded-full object-cover border-2 border-green-600"
        height="80"
        loading="lazy"
        src="https://storage.googleapis.com/a1aa/image/7ff034be-0e3b-4e0c-d450-dcd511256a58.jpg"
        width="80"
      />
      <div>
       <h3 class="text-lg font-semibold text-gray-900">Rafael Oliveira</h3>
       <p class="text-sm text-gray-600">Engenheiro</p>
       <p class="text-sm text-green-600 flex items-center space-x-1">
        <i class="fas fa-map-marker-alt" aria-hidden="true"></i>
        <span>Localização: Escritório Central</span>
       </p>
      </div>
     </article>
    </div>
   </section>
   <!-- Perfil -->
   <section
     class="mb-10 max-w-md mx-auto bg-white rounded-lg shadow-md border border-gray-200 p-6"
     id="perfil"
     aria-label="Perfil do usuário"
     tabindex="-1"
   >
    <h2
      class="text-2xl font-semibold text-gray-800 mb-6 flex items-center justify-center space-x-2"
      tabindex="0"
    >
     <i class="fas fa-user-circle text-blue-600" aria-hidden="true"></i>
     <span>Meu Perfil</span>
    </h2>
    <div class="flex flex-col items-center space-y-4">
     <img
       alt="Foto do usuário atual, rosto sorridente de arquiteto, cabelo castanho curto e óculos"
       class="w-30 h-30 rounded-full object-cover border-4 border-blue-600"
       height="120"
       loading="lazy"
       src="https://storage.googleapis.com/a1aa/image/eb601d8e-aa89-4283-22a5-d5a475b2e898.jpg"
       width="120"
     />
     <h3 class="text-xl font-semibold text-gray-900" tabindex="0">João ninguem</h3>
     <p class="text-gray-600" tabindex="0">Arquiteto</p>
     <form class="w-full space-y-4" id="perfil-form" novalidate>
      <div>
       <label
         class="block text-gray-700 font-medium mb-1"
         for="nome"
         >Nome</label
       >
       <input
         class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600"
         id="nome"
         name="nome"
         required
         type="text"
         value="Lucas Silva"
         aria-required="true"
         aria-describedby="nome-error"
       />
       <p
         class="text-red-600 text-sm mt-1 hidden"
         id="nome-error"
         role="alert"
       >
        Por favor, insira seu nome.
       </p>
      </div>
      <div>
       <label
         class="block text-gray-700 font-medium mb-1"
         for="email"
         >Email</label
       >
       <input
         class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600"
         id="email"
         name="email"
         required
         type="email"
         value="joao.ninguem@empresa.com"
         aria-required="true"
         aria-describedby="email-error"
       />
       <p
         class="text-red-600 text-sm mt-1 hidden"
         id="email-error"
         role="alert"
       >
        Por favor, insira um email válido.
       </p>
      </div>
      <div>
       <label
         class="block text-gray-700 font-medium mb-1"
         for="telefone"
         >Telefone</label
       >
       <input
         class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600"
         id="telefone"
         name="telefone"
         required
         type="tel"
         value="+55 11 91234-5678"
         aria-required="true"
         aria-describedby="telefone-error"
       />
       <p
         class="text-red-600 text-sm mt-1 hidden"
         id="telefone-error"
         role="alert"
       >
        Por favor, insira um telefone válido.
       </p>
      </div>
      <div>
       <label
         class="block text-gray-700 font-medium mb-1"
         for="info-adicional"
         >Informações adicionais</label
       >
       <textarea
         class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600 resize-y"
         id="info-adicional"
         name="infoAdicional"
         rows="3"
         placeholder="Ex: Especialidades, preferências, observações..."
         aria-describedby="info-adicional-desc"
       ></textarea>
       <p class="text-gray-500 text-sm mt-1" id="info-adicional-desc">
        Campo opcional para personalizar seu perfil.
       </p>
      </div>
      <button
        aria-label="Salvar alterações do perfil"
        class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 rounded-md shadow-md transition focus-visible:outline focus-visible:outline-2 focus-visible:outline-blue-600"
        type="submit"
      >
       Salvar Alterações
      </button>
     </form>
     <p
       aria-live="polite"
       class="text-green-600 font-semibold hidden"
       id="perfil-msg"
       role="alert"
     >
      Perfil atualizado com sucesso!
     </p>
    </div>
   </section>
   <!-- Histórico de Atividades -->
   <section
     class="mb-10 max-w-4xl mx-auto bg-white rounded-lg shadow-md border border-gray-200 p-6"
     id="historico"
     aria-label="Histórico de atividades"
     tabindex="-1"
   >
    <h2
      class="text-2xl font-semibold text-gray-800 mb-4 flex items-center justify-center space-x-2"
      tabindex="0"
    >
     <i class="fas fa-history text-blue-600" aria-hidden="true"></i>
     <span>Histórico de Atividades</span>
    </h2>
    <div
      id="activity-log"
      class="overflow-y-auto max-h-52 border border-gray-300 rounded-md p-3 bg-gray-50"
      tabindex="0"
      aria-live="polite"
      aria-relevant="additions"
    >
     <p class="text-gray-500 text-center select-none" id="no-activity-msg">
      Nenhuma atividade registrada ainda.
     </p>
    </div>
   </section>
   <!-- Calendário Tekton -->
   <section
     class="mb-10"
     id="calendario"
     aria-label="Calendário Tekton"
     tabindex="-1"
   >
    <h2
      class="text-2xl font-semibold text-gray-800 mb-4 flex items-center justify-center space-x-2"
      tabindex="0"
    >
     <i class="fas fa-calendar-alt text-blue-600" aria-hidden="true"></i>
     <span>Calendário Tekton</span>
    </h2>
    <div id="tekton-calendar" role="application" aria-label="Calendário Tekton">
     <div id="calendar-header" class="select-none">
      <button
        id="prev-month"
        aria-label="Mês anterior"
        title="Mês anterior"
        type="button"
      >
       <i class="fas fa-chevron-left"></i>
      </button>
      <h3 id="month-year" tabindex="0" aria-live="polite" aria-atomic="true"></h3>
      <button
        id="next-month"
        aria-label="Próximo mês"
        title="Próximo mês"
        type="button"
      >
       <i class="fas fa-chevron-right"></i>
      </button>
     </div>
     <div id="calendar-weekdays" aria-hidden="true">
      <div>Dom</div>
      <div>Seg</div>
      <div>Ter</div>
      <div>Qua</div>
      <div>Qui</div>
      <div>Sex</div>
      <div>Sáb</div>
     </div>
     <div id="calendar-days" tabindex="0" aria-label="Dias do mês"></div>
    </div>
   </section>
  </main>
  <footer
    class="bg-white border-t border-gray-200 py-4 text-center text-gray-600 text-sm"
    tabindex="0"
  >
   © 2024 Equipe de Arquitetura - Sistema Interno de Navegação
  </footer>

  <!-- Modal para detalhes do evento -->
  <div
    id="event-modal"
    role="dialog"
    aria-modal="true"
    aria-labelledby="event-modal-title"
    aria-describedby="event-modal-desc"
    tabindex="-1"
  >
   <div id="event-modal-content" tabindex="0">
    <button
      id="event-modal-close"
      aria-label="Fechar detalhes do evento"
      title="Fechar"
      type="button"
    >
     &times;
    </button>
    <h3 id="event-modal-title"></h3>
    <p id="event-modal-desc"></p>
   </div>
  </div>

  <script>
    // Dados simulados da equipe com posições (latitude e longitude fictícios)
    const equipe = [
      {
        id: 1,
        nome: "Lucas Silva",
        cargo: "Arquiteto",
        lat: -23.55052,
        lng: -46.633308,
        localizacao: "Canteiro A",
        tipo: "architect",
        color: "#2563eb",
      },
      {
        id: 2,
        nome: "Mariana Costa",
        cargo: "Engenheira",
        lat: -23.5515,
        lng: -46.6345,
        localizacao: "Canteiro B",
        tipo: "engineer",
        color: "#16a34a",
      },
      {
        id: 3,
        nome: "Ana Pereira",
        cargo: "Arquiteta",
        lat: -23.549,
        lng: -46.632,
        localizacao: "Escritório Central",
        tipo: "architect",
        color: "#2563eb",
      },
      {
        id: 4,
        nome: "Carlos Mendes",
        cargo: "Engenheiro",
        lat: -23.552,
        lng: -46.635,
        localizacao: "Canteiro C",
        tipo: "engineer",
        color: "#16a34a",
      },
      {
        id: 5,
        nome: "Beatriz Lima",
        cargo: "Arquiteta",
        lat: -23.5485,
        lng: -46.6315,
        localizacao: "Escritório Central",
        tipo: "architect",
        color: "#2563eb",
      },
      {
        id: 6,
        nome: "Felipe Santos",
        cargo: "Engenheiro",
        lat: -23.55,
        lng: -46.633,
        localizacao: "Canteiro A",
        tipo: "engineer",
        color: "#16a34a",
      },
      {
        id: 7,
        nome: "Joana Ribeiro",
        cargo: "Arquiteta",
        lat: -23.551,
        lng: -46.634,
        localizacao: "Canteiro B",
        tipo: "architect",
        color: "#2563eb",
      },
      {
        id: 8,
        nome: "Rafael Oliveira",
        cargo: "Engenheiro",
        lat: -23.5495,
        lng: -46.6325,
        localizacao: "Escritório Central",
        tipo: "engineer",
        color: "#16a34a",
      },
    ];

    // Tarefas simuladas
    const tarefas = [
      {
        id: 1,
        titulo: "Visita ao canteiro A",
        descricao: "Conferir alinhamento das paredes e posicionamento das janelas.",
        prazo: "2024-06-28",
        status: "Em andamento",
        responsavelId: 1,
      },
      {
        id: 2,
        titulo: "Revisão do projeto estrutural",
        descricao: "Validar cálculos e materiais com o engenheiro responsável.",
        prazo: "2024-06-30",
        status: "Pendente",
        responsavelId: 2,
      },
      {
        id: 3,
        titulo: "Atualizar planta baixa",
        descricao: "Incorporar alterações solicitadas pelo cliente.",
        prazo: "2024-07-02",
        status: "Atrasada",
        responsavelId: 3,
      },
      {
        id: 4,
        titulo: "Inspeção elétrica",
        descricao: "Verificar instalação e segurança dos cabos.",
        prazo: "2024-07-05",
        status: "Pendente",
        responsavelId: 4,
      },
      {
        id: 5,
        titulo: "Reunião com cliente",
        descricao: "Apresentar progresso e discutir ajustes.",
        prazo: "2024-07-07",
        status: "Em andamento",
        responsavelId: 5,
      },
      {
        id: 6,
        titulo: "Levantamento topográfico",
        descricao: "Coletar dados para atualização do projeto.",
        prazo: "2024-07-10",
        status: "Pendente",
        responsavelId: 6,
      },
    ];

    // Limites fictícios para o mapa (latitude e longitude)
    const mapBounds = {
      north: -23.547,
      south: -23.553,
      east: -46.631,
      west: -46.636,
    };

    // Referência ao container do mapa
    const mapEl = document.getElementById("map");

    // Converte lat/lng para % dentro do container do mapa
    function latLngToPercent(lat, lng) {
      const latPercent = ((mapBounds.north - lat) / (mapBounds.north - mapBounds.south)) * 100;
      const lngPercent = ((lng - mapBounds.west) / (mapBounds.east - mapBounds.west)) * 100;
      return { top: latPercent, left: lngPercent };
    }

    // Remove todos os marcadores do mapa
    function limparMarcadores() {
      const markers = mapEl.querySelectorAll(".marker");
      markers.forEach((m) => m.remove());
    }

    // Cria marcadores no mapa para cada membro da equipe
    function criarMarcadores() {
      limparMarcadores();
      equipe.forEach((membro) => {
        const pos = latLngToPercent(membro.lat, membro.lng);
        const marker = document.createElement("div");
        marker.className = `marker ${membro.tipo === "engineer" ? "engineer" : "architect"}`;
        marker.style.top = pos.top + "%";
        marker.style.left = pos.left + "%";
        marker.setAttribute("tabindex", "0");
        marker.setAttribute(
          "aria-label",
          `${membro.nome}, ${membro.cargo}, localizado em ${membro.localizacao}`
        );
        marker.setAttribute("role", "button");

        const icon = document.createElement("i");
        icon.className = "icon fas fa-map-marker-alt";
        marker.appendChild(icon);

        const tooltip = document.createElement("div");
        tooltip.className = "tooltip";
        tooltip.textContent = `${membro.nome} (${membro.cargo}) - ${membro.localizacao}`;
        marker.appendChild(tooltip);

        // Clique ou Enter/Space no marcador mostra alerta com detalhes
        marker.addEventListener("click", () => {
          alert(
            `Nome: ${membro.nome}\nCargo: ${membro.cargo}\nLocalização: ${membro.localizacao}`
          );
          adicionarAtividade(`Visualizou detalhes de ${membro.nome} no mapa.`);
        });
        marker.addEventListener("keydown", (e) => {
          if (e.key === "Enter" || e.key === " ") {
            e.preventDefault();
            marker.click();
          }
        });

        mapEl.appendChild(marker);
      });
    }

    criarMarcadores();

    // Feedback do mapa
    const mapFeedback = document.getElementById("map-feedback");

    // Botão Ativar GPS
    document.getElementById("btn-ativar-gps").addEventListener("click", () => {
      if (!navigator.geolocation) {
        mapFeedback.textContent = "Geolocalização não suportada pelo seu navegador.";
        mapFeedback.classList.remove("hidden");
        mapFeedback.classList.remove("text-green-700");
        mapFeedback.classList.add("text-red-700");
        return;
      }
      navigator.geolocation.getCurrentPosition(
        (pos) => {
          mapFeedback.textContent = `GPS ativado. Sua localização atual: Latitude: ${pos.coords.latitude.toFixed(
            5
          )}, Longitude: ${pos.coords.longitude.toFixed(5)}`;
          mapFeedback.classList.remove("hidden", "text-red-700");
          mapFeedback.classList.add("text-green-700");
          adicionarAtividade("Usuário ativou GPS e obteve localização atual.");
        },
        () => {
          mapFeedback.textContent = "Não foi possível obter sua localização.";
          mapFeedback.classList.remove("hidden", "text-green-700");
          mapFeedback.classList.add("text-red-700");
        }
      );
    });

    // Botão Gerar Rota (simulação)
    document.getElementById("btn-gerar-rota").addEventListener("click", () => {
      if (equipe.length < 2) {
        mapFeedback.textContent = "Equipe insuficiente para gerar rota.";
        mapFeedback.classList.remove("hidden", "text-green-700");
        mapFeedback.classList.add("text-red-700");
        return;
      }
      const origem = equipe[0];
      const destino = equipe[1];
      mapFeedback.textContent = `Rota gerada: De: ${origem.nome} (${origem.localizacao}) Para: ${destino.nome} (${destino.localizacao}) Distância aproximada: 1.2 km Tempo estimado: 5 minutos`;
      mapFeedback.classList.remove("hidden", "text-red-700");
      mapFeedback.classList.add("text-green-700");
      adicionarAtividade(
        `Rota gerada entre ${origem.nome} e ${destino.nome}.`
      );
    });

    // Botão Atualizar Posições (simula pequenas variações)
    document.getElementById("btn-atualizar-posicao").addEventListener("click", () => {
      equipe.forEach((membro) => {
        membro.lat += (Math.random() - 0.5) * 0.0004;
        membro.lng += (Math.random() - 0.5) * 0.0004;
      });
      criarMarcadores();
      mapFeedback.textContent = "Posições da equipe atualizadas.";
      mapFeedback.classList.remove("hidden", "text-red-700");
      mapFeedback.classList.add("text-green-700");
      adicionarAtividade("Posições da equipe atualizadas.");
    });

    // Marcar tarefa como concluída / pendente
    document.querySelectorAll(".btn-concluir").forEach((btn) => {
      btn.addEventListener("click", () => {
        const article = btn.closest("article");
        const statusSpan = article.querySelector(".status");
        const tarefaId = Number(article.getAttribute("data-id"));
        const tarefa = tarefas.find((t) => t.id === tarefaId);
        if (!tarefa) return;

        if (tarefa.status === "Concluída") {
          tarefa.status = "Pendente";
          statusSpan.textContent = "Pendente";
          statusSpan.className =
            "status text-sm font-medium text-yellow-700 bg-yellow-100 px-2 py-1 rounded-full";
          adicionarAtividade(`Tarefa "${tarefa.titulo}" marcada como Pendente.`);
        } else {
          tarefa.status = "Concluída";
          statusSpan.textContent = "Concluída";
          statusSpan.className =
            "status text-sm font-medium text-green-700 bg-green-100 px-2 py-1 rounded-full";
          adicionarAtividade(`Tarefa "${tarefa.titulo}" marcada como Concluída.`);
        }
      });
    });

    // Formulário perfil - salvar alterações simuladas
    const perfilForm = document.getElementById("perfil-form");
    const perfilMsg = document.getElementById("perfil-msg");

    // Validation helpers
    function validateEmail(email) {
      // Simple email regex
      return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
    }
    function validatePhone(phone) {
      // Simple phone regex (Brazilian format)
      return /^\+?[\d\s()-]{8,}$/.test(phone);
    }

    perfilForm.addEventListener("submit", (e) => {
      e.preventDefault();

      // Clear previous errors
      ["nome", "email", "telefone"].forEach((id) => {
        document.getElementById(id + "-error").classList.add("hidden");
      });

      const nome = perfilForm.nome.value.trim();
      const email = perfilForm.email.value.trim();
      const telefone = perfilForm.telefone.value.trim();
      const infoAdicional = perfilForm["infoAdicional"].value.trim();

      let valid = true;

      if (!nome) {
        document.getElementById("nome-error").classList.remove("hidden");
        valid = false;
      }
      if (!email || !validateEmail(email)) {
        document.getElementById("email-error").classList.remove("hidden");
        valid = false;
      }
      if (!telefone || !validatePhone(telefone)) {
        document.getElementById("telefone-error").classList.remove("hidden");
        valid = false;
      }

      if (!valid) {
        perfilMsg.classList.add("hidden");
        return;
      }

      // Simula salvar dados (poderia ser API)
      equipe[0].nome = nome;
      equipe[0].infoAdicional = infoAdicional;

      perfilMsg.textContent = "Perfil atualizado com sucesso!";
      perfilMsg.classList.remove("hidden");
      adicionarAtividade("Perfil do usuário atualizado.");

      setTimeout(() => {
        perfilMsg.classList.add("hidden");
      }, 4000);
    });

    // Histórico de atividades
    const activityLog = document.getElementById("activity-log");
    const noActivityMsg = document.getElementById("no-activity-msg");

    function adicionarAtividade(texto) {
      if (!texto) return;
      if (!noActivityMsg.classList.contains("hidden")) {
        noActivityMsg.classList.add("hidden");
      }
      const time = new Date();
      const timeStr = time.toLocaleString("pt-BR", {
        dateStyle: "short",
        timeStyle: "short",
      });
      const entry = document.createElement("div");
      entry.className =
        "mb-2 border-b border-gray-300 pb-1 text-gray-700 text-sm select-text";
      entry.textContent = `[${timeStr}] ${texto}`;
      activityLog.prepend(entry);
    }

    // Calendário Tekton
    const calendarDaysEl = document.getElementById("calendar-days");
    const monthYearEl = document.getElementById("month-year");
    const prevMonthBtn = document.getElementById("prev-month");
    const nextMonthBtn = document.getElementById("next-month");
    const eventModal = document.getElementById("event-modal");
    const eventModalContent = document.getElementById("event-modal-content");
    const eventModalTitle = document.getElementById("event-modal-title");
    const eventModalDesc = document.getElementById("event-modal-desc");
    const eventModalClose = document.getElementById("event-modal-close");

    let currentDate = new Date();

    function formatDateISO(date) {
      return date.toISOString().split("T")[0];
    }

    function isSameDate(d1, d2) {
      return (
        d1.getFullYear() === d2.getFullYear() &&
        d1.getMonth() === d2.getMonth() &&
        d1.getDate() === d2.getDate()
      );
    }

    function renderCalendar(date) {
      calendarDaysEl.innerHTML = "";
      const year = date.getFullYear();
      const month = date.getMonth();

      // Set month-year header
      const monthNames = [
        "Janeiro",
        "Fevereiro",
        "Março",
        "Abril",
        "Maio",
        "Junho",
        "Julho",
        "Agosto",
        "Setembro",
        "Outubro",
        "Novembro",
        "Dezembro",
      ];
      monthYearEl.textContent = `${monthNames[month]} ${year}`;

      // First day of month
      const firstDay = new Date(year, month, 1);
      // Last day of month
      const lastDay = new Date(year, month + 1, 0);
      // Day of week of first day (0=Domingo)
      const startDay = firstDay.getDay();

      // Days in previous month to show
      const prevMonthLastDay = new Date(year, month, 0).getDate();

      // Total cells to render (6 rows x 7 days = 42)
      const totalCells = 42;

      // Today for highlight
      const today = new Date();

      for (let i = 0; i < totalCells; i++) {
        const dayEl = document.createElement("div");
        dayEl.className = "calendar-day";
        dayEl.setAttribute("tabindex", "0");
        dayEl.setAttribute("role", "button");

        let dayNumber;
        let dayDate;
        let inactive = false;

        if (i < startDay) {
          // Days from previous month
          dayNumber = prevMonthLastDay - (startDay - 1 - i);
          dayDate = new Date(year, month - 1, dayNumber);
          inactive = true;
        } else if (i >= startDay + lastDay.getDate()) {
          // Days from next month
          dayNumber = i - (startDay + lastDay.getDate()) + 1;
          dayDate = new Date(year, month + 1, dayNumber);
          inactive = true;
        } else {
          // Current month days
          dayNumber = i - startDay + 1;
          dayDate = new Date(year, month, dayNumber);
        }

        dayEl.classList.toggle("inactive", inactive);
        if (isSameDate(dayDate, today)) {
          dayEl.classList.add("today");
        }

        const dayNumberEl = document.createElement("div");
        dayNumberEl.className = "day-number";
        dayNumberEl.textContent = dayNumber;
        dayEl.appendChild(dayNumberEl);

        // Add events for this day
        const eventsContainer = document.createElement("div");
        eventsContainer.className = "events-container";

        // Filter tarefas for this day
        const dayISO = dayDate.toISOString().split("T")[0];
        const dayEvents = tarefas.filter((t) => t.prazo === dayISO);

        dayEvents.forEach((evento) => {
          const eventEl = document.createElement("div");
          eventEl.className = "event";
          // Color by responsible type
          const responsavel = equipe.find((m) => m.id === evento.responsavelId);
          if (responsavel && responsavel.tipo === "engineer") {
            eventEl.classList.add("engineer");
          }
          eventEl.textContent = evento.titulo;
          eventEl.setAttribute("tabindex", "0");
          eventEl.setAttribute("role", "button");
          eventEl.setAttribute(
            "aria-label",
            `Evento: ${evento.titulo}, status: ${evento.status}, responsável: ${
              responsavel ? responsavel.nome : "Desconhecido"
            }`
          );
          eventEl.addEventListener("click", () => {
            abrirModalEvento(evento, responsavel);
          });
          eventEl.addEventListener("keydown", (e) => {
            if (e.key === "Enter" || e.key === " ") {
              e.preventDefault();
              abrirModalEvento(evento, responsavel);
            }
          });
          eventsContainer.appendChild(eventEl);
        });

        dayEl.appendChild(eventsContainer);

        // Click day to add new event
        dayEl.addEventListener("click", () => {
          abrirModalEvento(null, null, dayDate);
        });
        dayEl.addEventListener("keydown", (e) => {
          if (e.key === "Enter" || e.key === " ") {
            e.preventDefault();
            abrirModalEvento(null, null, dayDate);
          }
        });

        calendarDaysEl.appendChild(dayEl);
      }
    }

    // Modal event handlers
    function abrirModalEvento(evento, responsavel, data = null) {
      eventModal.classList.add("active");
      eventModalContent.focus();

      if (evento) {
        eventModalTitle.textContent = evento.titulo;
        eventModalDesc.textContent =
          `Descrição: ${evento.descricao}\n` +
          `Prazo: ${evento.prazo}\n` +
          `Status: ${evento.status}\n` +
          `Responsável: ${responsavel ? responsavel.nome : "Desconhecido"}`;
      } else if (data) {
        eventModalTitle.textContent = `Nova tarefa para ${data.toLocaleDateString(
          "pt-BR"
        )}`;
        eventModalDesc.textContent =
          "Para adicionar uma nova tarefa, utilize o formulário de tarefas (não implementado nesta versão).";
      } else {
        eventModalTitle.textContent = "Detalhes do evento";
        eventModalDesc.textContent = "Nenhuma informação disponível.";
      }
    }

    function fecharModalEvento() {
      eventModal.classList.remove("active");
      // Retorna foco para calendário
      calendarDaysEl.focus();
    }

    eventModalClose.addEventListener("click", fecharModalEvento);
    eventModal.addEventListener("click", (e) => {
      if (e.target === eventModal) {
        fecharModalEvento();
      }
    });
    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape" && eventModal.classList.contains("active")) {
        fecharModalEvento();
      }
    });

    // Navegação meses
    prevMonthBtn.addEventListener("click", () => {
      currentDate.setMonth(currentDate.getMonth() - 1);
      renderCalendar(currentDate);
    });
    nextMonthBtn.addEventListener("click", () => {
      currentDate.setMonth(currentDate.getMonth() + 1);
      renderCalendar(currentDate);
    });

    // Inicializa calendário
    renderCalendar(currentDate);
  </script>
 </body>
</html>